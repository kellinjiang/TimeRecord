<!--pages/memo-list/memo-list.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨ç­›é€‰ -->
  <view class="filter-bar">
    <view
      class="filter-item {{filterType === 'all' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-type="all"
    >
      å…¨éƒ¨
    </view>
    <view
      class="filter-item {{filterType === 'pending' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-type="pending"
    >
      æœªå®Œæˆ
    </view>
    <view
      class="filter-item {{filterType === 'completed' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-type="completed"
    >
      å·²å®Œæˆ
    </view>
  </view>

  <!-- å¤‡å¿˜å½•åˆ—è¡¨ -->
  <scroll-view class="memo-scroll" scroll-y enable-back-to-top>
    <!-- ä»Šå¤© -->
    <view class="time-group" wx:if="{{todayMemos.length > 0}}">
      <view class="group-title">ğŸ“… ä»Šå¤© ({{todayMemos.length}})</view>
      <view class="memo-list">
        <view
          class="memo-item {{item.isCompleted ? 'completed' : ''}}"
          wx:for="{{todayMemos}}"
          wx:key="_id"
          bindtap="goToEdit"
          data-id="{{item._id}}"
        >
          <view class="memo-left">
            <view class="priority-badge priority-{{item.priority}}">
              {{item.priorityLabel}}
            </view>
            <view class="memo-info">
              <view class="memo-time">{{item.reminderTimeStr}}</view>
              <view class="memo-title">{{item.title}}</view>
              <view class="memo-content" wx:if="{{item.content}}">{{item.content}}</view>
            </view>
          </view>
          <view class="memo-right">
            <view
              class="check-btn {{item.isCompleted ? 'checked' : ''}}"
              catchtap="toggleComplete"
              data-id="{{item._id}}"
              data-completed="{{item.isCompleted}}"
            >
              <text class="check-icon">{{item.isCompleted ? 'âœ“' : ''}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ˜å¤© -->
    <view class="time-group" wx:if="{{tomorrowMemos.length > 0}}">
      <view class="group-title">ğŸ“… æ˜å¤© ({{tomorrowMemos.length}})</view>
      <view class="memo-list">
        <view
          class="memo-item {{item.isCompleted ? 'completed' : ''}}"
          wx:for="{{tomorrowMemos}}"
          wx:key="_id"
          bindtap="goToEdit"
          data-id="{{item._id}}"
        >
          <view class="memo-left">
            <view class="priority-badge priority-{{item.priority}}">
              {{item.priorityLabel}}
            </view>
            <view class="memo-info">
              <view class="memo-time">{{item.reminderTimeStr}}</view>
              <view class="memo-title">{{item.title}}</view>
              <view class="memo-content" wx:if="{{item.content}}">{{item.content}}</view>
            </view>
          </view>
          <view class="memo-right">
            <view
              class="check-btn {{item.isCompleted ? 'checked' : ''}}"
              catchtap="toggleComplete"
              data-id="{{item._id}}"
              data-completed="{{item.isCompleted}}"
            >
              <text class="check-icon">{{item.isCompleted ? 'âœ“' : ''}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æœ¬å‘¨ -->
    <view class="time-group" wx:if="{{thisWeekMemos.length > 0}}">
      <view class="group-title">ğŸ“… æœ¬å‘¨ ({{thisWeekMemos.length}})</view>
      <view class="memo-list">
        <view
          class="memo-item {{item.isCompleted ? 'completed' : ''}}"
          wx:for="{{thisWeekMemos}}"
          wx:key="_id"
          bindtap="goToEdit"
          data-id="{{item._id}}"
        >
          <view class="memo-left">
            <view class="priority-badge priority-{{item.priority}}">
              {{item.priorityLabel}}
            </view>
            <view class="memo-info">
              <view class="memo-time">{{item.reminderDateStr}} {{item.reminderTimeStr}}</view>
              <view class="memo-title">{{item.title}}</view>
              <view class="memo-content" wx:if="{{item.content}}">{{item.content}}</view>
            </view>
          </view>
          <view class="memo-right">
            <view
              class="check-btn {{item.isCompleted ? 'checked' : ''}}"
              catchtap="toggleComplete"
              data-id="{{item._id}}"
              data-completed="{{item.isCompleted}}"
            >
              <text class="check-icon">{{item.isCompleted ? 'âœ“' : ''}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æœªæ¥ -->
    <view class="time-group" wx:if="{{futureMemos.length > 0}}">
      <view class="group-title">ğŸ“… æœªæ¥ ({{futureMemos.length}})</view>
      <view class="memo-list">
        <view
          class="memo-item {{item.isCompleted ? 'completed' : ''}}"
          wx:for="{{futureMemos}}"
          wx:key="_id"
          bindtap="goToEdit"
          data-id="{{item._id}}"
        >
          <view class="memo-left">
            <view class="priority-badge priority-{{item.priority}}">
              {{item.priorityLabel}}
            </view>
            <view class="memo-info">
              <view class="memo-time">{{item.reminderDateStr}} {{item.reminderTimeStr}}</view>
              <view class="memo-title">{{item.title}}</view>
              <view class="memo-content" wx:if="{{item.content}}">{{item.content}}</view>
            </view>
          </view>
          <view class="memo-right">
            <view
              class="check-btn {{item.isCompleted ? 'checked' : ''}}"
              catchtap="toggleComplete"
              data-id="{{item._id}}"
              data-completed="{{item.isCompleted}}"
            >
              <text class="check-icon">{{item.isCompleted ? 'âœ“' : ''}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{memoList.length === 0}}">
      <view class="empty-icon">ğŸ“</view>
      <view class="empty-text">æš‚æ— å¤‡å¿˜å½•</view>
      <view class="empty-tip">ç‚¹å‡»å³ä¸‹è§’æ·»åŠ æ–°å¤‡å¿˜å½•</view>
    </view>

    <!-- åº•éƒ¨å ä½ -->
    <view style="height: 100rpx;"></view>
  </scroll-view>

  <!-- æ–°å¢æŒ‰é’® -->
  <view class="add-btn" bindtap="goToAdd">
    <text class="add-icon">+</text>
  </view>
</view>
