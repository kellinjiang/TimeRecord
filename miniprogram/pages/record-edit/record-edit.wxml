<!--pages/record-edit/record-edit.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ ï¼ˆå·²ç”±ç³»ç»Ÿæä¾›ï¼‰ -->

  <!-- å¼€å§‹æ—¶é—´ -->
  <view class="form-section">
    <view class="section-label">
      <text>â° å¼€å§‹æ—¶é—´</text>
    </view>
    <picker mode="time" value="{{startTime}}" bindchange="onTimeChange">
      <view class="time-picker">
        <text class="time-value">{{startTime || 'è¯·é€‰æ‹©æ—¶é—´'}}</text>
        <text class="arrow">â€º</text>
      </view>
    </picker>
  </view>

  <!-- å½•éŸ³æ’­æ”¾ï¼ˆå¦‚æœæœ‰å½•éŸ³ï¼‰ -->
  <view class="form-section" wx:if="{{audioPath}}">
    <view class="section-label">
      <text>ğŸ¤ å½•éŸ³</text>
    </view>
    <view class="audio-player" bindtap="playAudio">
      <text class="audio-icon">{{isPlaying ? 'â¸' : 'â–¶ï¸'}}</text>
      <text class="audio-text">{{isPlaying ? 'æ’­æ”¾ä¸­...' : 'ç‚¹å‡»æ’­æ”¾å½•éŸ³'}}</text>
    </view>
  </view>

  <!-- æ—¥è®°å†…å®¹ -->
  <view class="form-section">
    <view class="section-label">
      <text>ğŸ“ å†…å®¹</text>
      <text class="char-count">{{content.length}}/500</text>
    </view>
    <view class="input-tip">ğŸ’¡ å¯ä½¿ç”¨å¾®ä¿¡é”®ç›˜çš„è¯­éŸ³è¾“å…¥åŠŸèƒ½</view>
    <textarea
      class="content-input"
      placeholder="è¯·è¾“å…¥æˆ–ä¿®æ”¹æ—¥è®°å†…å®¹..."
      value="{{content}}"
      bindinput="onContentInput"
      maxlength="500"
      auto-height
      cursor-spacing="20"
    />
  </view>

  <!-- å¿«é€Ÿæ ‡ç­¾ -->
  <view class="form-section">
    <view class="section-label">
      <text>ğŸ·ï¸ æ ‡ç­¾</text>
    </view>
    <view class="tags-container">
      <view
        class="tag-item {{item.selected ? 'selected' : ''}}"
        wx:for="{{quickTags}}"
        wx:key="name"
        bindtap="toggleTag"
        data-index="{{index}}"
        style="background-color: {{item.selected ? item.color + '20' : '#f5f5f5'}}; color: {{item.selected ? item.color : '#666'}}"
      >
        <text>{{item.icon}} {{item.name}}</text>
      </view>
      <view class="tag-item more-tag" bindtap="showMoreTags">
        <text>+ æ›´å¤š</text>
      </view>
    </view>
  </view>

  <!-- å¸¸ç”¨æ¨¡æ¿ -->
  <view class="form-section" wx:if="{{templates.length > 0}}">
    <view class="section-label">
      <text>ğŸ“‹ å¸¸ç”¨æ¨¡æ¿</text>
    </view>
    <scroll-view class="templates-scroll" scroll-x>
      <view class="templates-container">
        <view
          class="template-item"
          wx:for="{{templates}}"
          wx:key="name"
          bindtap="useTemplate"
          data-index="{{index}}"
        >
          <text>{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="footer-actions">
    <button class="btn-cancel" bindtap="onCancel">å–æ¶ˆ</button>
    <button class="btn-save" bindtap="onSave">ä¿å­˜</button>
  </view>
</view>

<!-- æ›´å¤šæ ‡ç­¾å¼¹çª— -->
<view class="modal {{showTagModal ? 'show' : ''}}" catchtap="hideTagModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">é€‰æ‹©æ ‡ç­¾</text>
      <text class="modal-close" bindtap="hideTagModal">âœ•</text>
    </view>
    <view class="modal-body">
      <view class="all-tags">
        <view
          class="tag-item {{item.selected ? 'selected' : ''}}"
          wx:for="{{allTags}}"
          wx:key="name"
          bindtap="toggleTagInModal"
          data-index="{{index}}"
          style="background-color: {{item.selected ? item.color + '20' : '#f5f5f5'}}; color: {{item.selected ? item.color : '#666'}}"
        >
          <text>{{item.icon}} {{item.name}}</text>
        </view>
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn-confirm" bindtap="confirmTags">ç¡®å®š</button>
    </view>
  </view>
</view>
