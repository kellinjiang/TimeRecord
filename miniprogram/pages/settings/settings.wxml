<!--pages/settings/settings.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-avatar-wrapper">
      <image
        wx:if="{{userInfo.avatarUrl}}"
        class="user-avatar"
        src="{{userInfo.avatarUrl}}"
        mode="aspectFill"
        binderror="onAvatarError"
      ></image>
      <view wx:else class="user-avatar-placeholder">
        <text class="avatar-text">ğŸ‘¤</text>
      </view>
    </view>
    <view class="user-info">
      <view class="user-name">{{userInfo.nickName || 'æœªç™»å½•'}}</view>
      <view class="user-days">å·²ä½¿ç”¨ {{usageDays}} å¤©</view>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡æ€»è§ˆ -->
  <view class="stats-section">
    <view class="section-title">ğŸ“Š æ•°æ®æ€»è§ˆ</view>
    <view class="stats-grid">
      <view class="stat-card">
        <view class="stat-value">{{totalStats.totalRecords}}</view>
        <view class="stat-label">æ€»è®°å½•æ•°</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{totalStats.totalHours}}h</view>
        <view class="stat-label">æ€»æ—¶é•¿</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{totalStats.activeDays}}</view>
        <view class="stat-label">æ´»è·ƒå¤©æ•°</view>
      </view>
      <view class="stat-card">
        <view class="stat-value">{{totalStats.tagCount}}</view>
        <view class="stat-label">æ ‡ç­¾æ•°é‡</view>
      </view>
    </view>
  </view>

  <!-- æ ‡ç­¾ç»Ÿè®¡ -->
  <view class="tags-section" wx:if="{{topTags.length > 0}}">
    <view class="section-title">ğŸ·ï¸ å¸¸ç”¨æ ‡ç­¾ï¼ˆTop 5ï¼‰</view>
    <view class="tag-list">
      <view
        class="tag-item"
        wx:for="{{topTags}}"
        wx:key="name"
      >
        <view class="tag-info">
          <text class="tag-icon">{{item.icon}}</text>
          <text class="tag-name">{{item.name}}</text>
        </view>
        <view class="tag-hours">{{item.hours}}h</view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½å…¥å£ -->
  <view class="menu-section">
    <view class="section-title">âš™ï¸ åŠŸèƒ½ç®¡ç†</view>
    <view class="menu-list">
      <!-- å¤‡å¿˜å½•ç®¡ç† -->
      <view class="menu-item" bindtap="goToMemoManage">
        <view class="menu-left">
          <view class="menu-icon">ğŸ“</view>
          <view class="menu-text">å¤‡å¿˜å½•ç®¡ç†</view>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">â€º</text>
        </view>
      </view>

      <!-- æ ‡ç­¾ç®¡ç† -->
      <view class="menu-item" bindtap="goToTagManage">
        <view class="menu-left">
          <view class="menu-icon">ğŸ·ï¸</view>
          <view class="menu-text">æ ‡ç­¾ç®¡ç†</view>
        </view>
        <view class="menu-right">
          <text class="menu-badge">{{totalStats.tagCount}}</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>

      <!-- æ¨¡æ¿ç®¡ç† -->
      <view class="menu-item" bindtap="goToTemplateManage">
        <view class="menu-left">
          <view class="menu-icon">ğŸ“‹</view>
          <view class="menu-text">æ¨¡æ¿ç®¡ç†</view>
        </view>
        <view class="menu-right">
          <text class="menu-badge">{{templateCount}}</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>

      <!-- æ•°æ®ç»Ÿè®¡ -->
      <view class="menu-item" bindtap="goToDataStats">
        <view class="menu-left">
          <view class="menu-icon">ğŸ“ˆ</view>
          <view class="menu-text">æ•°æ®ç»Ÿè®¡</view>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å…¶ä»–è®¾ç½® -->
  <view class="menu-section">
    <view class="section-title">ğŸ”§ å…¶ä»–</view>
    <view class="menu-list">
      <!-- æ•°æ®å¤‡ä»½ -->
      <view class="menu-item" bindtap="backupData">
        <view class="menu-left">
          <view class="menu-icon">ğŸ’¾</view>
          <view class="menu-text">æ•°æ®å¤‡ä»½</view>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">â€º</text>
        </view>
      </view>

      <!-- æ¸…é™¤ç¼“å­˜ -->
      <view class="menu-item" bindtap="clearCache">
        <view class="menu-left">
          <view class="menu-icon">ğŸ§¹</view>
          <view class="menu-text">æ¸…é™¤ç¼“å­˜</view>
        </view>
        <view class="menu-right">
          <text class="menu-desc">{{cacheSize}}</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>

      <!-- å…³äºæˆ‘ä»¬ -->
      <view class="menu-item" bindtap="showAbout">
        <view class="menu-left">
          <view class="menu-icon">â„¹ï¸</view>
          <view class="menu-text">å…³äºæˆ‘ä»¬</view>
        </view>
        <view class="menu-right">
          <text class="menu-desc">v1.0.0</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>

      <!-- é€€å‡ºç™»å½• / å»ç™»å½• -->
      <view class="menu-item" bindtap="logout">
        <view class="menu-left">
          <view class="menu-icon">{{isLoggedIn ? 'ğŸšª' : 'ğŸ”‘'}}</view>
          <view class="menu-text {{isLoggedIn ? 'menu-text-danger' : ''}}">{{isLoggedIn ? 'é€€å‡ºç™»å½•' : 'å»ç™»å½•'}}</view>
        </view>
        <view class="menu-right">
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºç™½å ä½ -->
  <view style="height: 40rpx;"></view>
</view>
