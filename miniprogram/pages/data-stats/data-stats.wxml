<!--æ•°æ®ç»Ÿè®¡é¡µé¢-->
<view class="container">

  <!-- æ—¶é—´ç»´åº¦é€‰æ‹© -->
  <view class="time-tabs">
    <view
      class="time-tab {{currentPeriod === 'today' ? 'active' : ''}}"
      bindtap="switchPeriod"
      data-period="today"
    >
      <text>ä»Šæ—¥</text>
    </view>
    <view
      class="time-tab {{currentPeriod === 'week' ? 'active' : ''}}"
      bindtap="switchPeriod"
      data-period="week"
    >
      <text>æœ¬å‘¨</text>
    </view>
    <view
      class="time-tab {{currentPeriod === 'month' ? 'active' : ''}}"
      bindtap="switchPeriod"
      data-period="month"
    >
      <text>æœ¬æœˆ</text>
    </view>
    <view
      class="time-tab {{currentPeriod === 'all' ? 'active' : ''}}"
      bindtap="switchPeriod"
      data-period="all"
    >
      <text>å…¨éƒ¨</text>
    </view>
  </view>

  <!-- æ ¸å¿ƒæ•°æ®æŒ‡æ ‡ -->
  <view class="stats-overview">
    <view class="stat-card primary">
      <view class="stat-icon">ğŸ“</view>
      <view class="stat-info">
        <view class="stat-value">{{stats.totalRecords}}</view>
        <view class="stat-label">è®°å½•æ•°</view>
      </view>
    </view>

    <view class="stat-card success">
      <view class="stat-icon">â±ï¸</view>
      <view class="stat-info">
        <view class="stat-value">{{stats.totalHours}}h</view>
        <view class="stat-label">æ€»æ—¶é•¿</view>
      </view>
    </view>

    <view class="stat-card warning">
      <view class="stat-icon">ğŸ“…</view>
      <view class="stat-info">
        <view class="stat-value">{{stats.activeDays}}</view>
        <view class="stat-label">æ´»è·ƒå¤©æ•°</view>
      </view>
    </view>

    <view class="stat-card info">
      <view class="stat-icon">â°</view>
      <view class="stat-info">
        <view class="stat-value">{{stats.avgHours}}h</view>
        <view class="stat-label">æ—¥å‡æ—¶é•¿</view>
      </view>
    </view>
  </view>

  <!-- æ ‡ç­¾åˆ†å¸ƒ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ğŸ·ï¸ æ ‡ç­¾åˆ†å¸ƒ</text>
      <text class="section-subtitle">Top 5</text>
    </view>

    <view class="tag-stats" wx:if="{{tagStats.length > 0}}">
      <view class="tag-stat-item" wx:for="{{tagStats}}" wx:key="name">
        <view class="tag-stat-header">
          <view class="tag-stat-info">
            <text class="tag-icon">{{item.icon}}</text>
            <text class="tag-name">{{item.name}}</text>
          </view>
          <view class="tag-stat-value">
            <text class="tag-hours">{{item.hours}}h</text>
            <text class="tag-percentage">{{item.percentage}}%</text>
          </view>
        </view>
        <view class="tag-progress-bar">
          <view
            class="tag-progress-fill"
            style="width: {{item.percentage}}%; background-color: {{item.color}};"
          ></view>
        </view>
      </view>
    </view>

    <view class="empty-hint" wx:if="{{tagStats.length === 0}}">
      <text>æš‚æ— æ•°æ®</text>
    </view>
  </view>

  <!-- æ—¶é—´è¶‹åŠ¿ -->
  <view class="section" wx:if="{{currentPeriod !== 'today'}}">
    <view class="section-header">
      <text class="section-title">ğŸ“ˆ æ—¶é—´è¶‹åŠ¿</text>
      <text class="section-subtitle">{{trendLabel}}</text>
    </view>

    <view class="trend-chart" wx:if="{{trendData.length > 0}}">
      <view class="chart-container">
        <view class="chart-bars">
          <view class="chart-bar-item" wx:for="{{trendData}}" wx:key="label">
            <view class="bar-container">
              <view
                class="bar-fill {{item.isToday ? 'highlight' : ''}}"
                style="height: {{item.percentage}}%;"
              >
                <text class="bar-value" wx:if="{{item.hours > 0}}">{{item.hours}}h</text>
              </view>
            </view>
            <text class="bar-label {{item.isToday ? 'today' : ''}}">{{item.label}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="empty-hint" wx:if="{{trendData.length === 0}}">
      <text>æš‚æ— æ•°æ®</text>
    </view>
  </view>

  <!-- è®°å½•åˆ†å¸ƒï¼ˆæŒ‰å°æ—¶ï¼‰ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">â° æ—¶æ®µåˆ†å¸ƒ</text>
      <text class="section-subtitle">24å°æ—¶</text>
    </view>

    <view class="hour-distribution" wx:if="{{hourDistribution.length > 0}}">
      <view class="hour-item" wx:for="{{hourDistribution}}" wx:key="hour">
        <text class="hour-label">{{item.hour}}:00</text>
        <view class="hour-bar-bg">
          <view
            class="hour-bar-fill"
            style="width: {{item.percentage}}%;"
          ></view>
        </view>
        <text class="hour-count">{{item.count}}</text>
      </view>
    </view>

    <view class="empty-hint" wx:if="{{hourDistribution.length === 0}}">
      <text>æš‚æ— æ•°æ®</text>
    </view>
  </view>

  <!-- æ˜ŸæœŸåˆ†å¸ƒ -->
  <view class="section" wx:if="{{currentPeriod !== 'today'}}">
    <view class="section-header">
      <text class="section-title">ğŸ“Š æ˜ŸæœŸåˆ†å¸ƒ</text>
      <text class="section-subtitle">å·¥ä½œæ—¥ vs å‘¨æœ«</text>
    </view>

    <view class="weekday-distribution" wx:if="{{weekdayStats.length > 0}}">
      <view class="weekday-item" wx:for="{{weekdayStats}}" wx:key="day">
        <view class="weekday-header">
          <text class="weekday-name">{{item.name}}</text>
          <text class="weekday-hours">{{item.hours}}h</text>
        </view>
        <view class="weekday-bar-bg">
          <view
            class="weekday-bar-fill {{item.isWeekend ? 'weekend' : 'weekday'}}"
            style="width: {{item.percentage}}%;"
          ></view>
        </view>
        <text class="weekday-count">{{item.count}}æ¡è®°å½•</text>
      </view>
    </view>

    <view class="empty-hint" wx:if="{{weekdayStats.length === 0}}">
      <text>æš‚æ— æ•°æ®</text>
    </view>
  </view>

  <!-- æ€»ç»“å¡ç‰‡ -->
  <view class="summary-card">
    <view class="summary-header">
      <text class="summary-icon">ğŸ’¡</text>
      <text class="summary-title">æ•°æ®æ´å¯Ÿ</text>
    </view>
    <view class="summary-content">
      <view class="summary-item" wx:if="{{stats.mostActiveDay}}">
        <text class="summary-label">æœ€æ´»è·ƒçš„ä¸€å¤©ï¼š</text>
        <text class="summary-value">{{stats.mostActiveDay}}</text>
      </view>
      <view class="summary-item" wx:if="{{stats.topTag}}">
        <text class="summary-label">æœ€å¸¸ç”¨æ ‡ç­¾ï¼š</text>
        <text class="summary-value">{{stats.topTag}}</text>
      </view>
      <view class="summary-item" wx:if="{{stats.avgRecordsPerDay}}">
        <text class="summary-label">æ—¥å‡è®°å½•æ•°ï¼š</text>
        <text class="summary-value">{{stats.avgRecordsPerDay}}æ¡</text>
      </view>
    </view>
  </view>

  <!-- ç©ºç™½å ä½ -->
  <view style="height: 40rpx;"></view>

</view>
